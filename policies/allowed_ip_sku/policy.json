{
    "properties": {
      "displayName": "This policy enables you to specify a set of IP addresses SKUs sizes that can be deployed in HMCTS",
      "policyType": "Custom",
      "description": "Prevent the creation of Basic SKU IP addresses in HMCTS",
      "mode": "Indexed",
      "parameters": {
        "allowedSKUs": {
          "type": "Array",
          "metadata": {
            "displayName": "Allowed IP Address SKU Types",
            "description": "The allowed IP Address SKU types in HMCTS"
          },
          "allowedValues": [
            "Standard"
          ],
          "defaultValue": [
            "Standard"
          ]
        },
        "exemptResourceNames": {
          "type": "Array",
          "metadata": {
            "displayName": "Exempt Resource Names",
            "description": "Names of Public IP resources to exempt from SKU enforcement"
          },
          "defaultValue": [
            "IP-MGT-OPS-SHS-OVPN-01-basic",
            "IP-MGT-VPN-01-basic",
            "IP-MLV-DMZ-FW-VPN-ENDPOINT-01-basic",
            "IP-PRD-DMZ-FW-PUBLIC-ENDPOINT-01-basic",
            "IP-PRD-DMZ-FW-VPN-ENDPOINT-01-basic",
            "IP-PRD-SHS-SPGateway-01-basic"
          ]
        }
      },
      "policyRule": {
        "if": {
          "allOf": [
            {
              "field": "type",
              "equals": "Microsoft.Network/publicIPAddresses"
            },
            {
              "not": {
                "field": "name",
                "in": "[parameters('exemptResourceNames')]"
              }
            },
            {
              "field": "Microsoft.Network/publicIPAddresses/sku.name",
              "notIn": "[parameters('allowedSKUs')]"
            }
          ]
        },
        "then": {
          "effect": "Deny"
        }
      }
    },
    "id": "/providers/Microsoft.Management/managementGroups/HMCTS/providers/Microsoft.Authorization/policyDefinitions/HMCTSIPSkuSize",
    "type": "Microsoft.Authorization/policyDefinitions",
    "name": "HMCTSIPSkuSize"
  }
  