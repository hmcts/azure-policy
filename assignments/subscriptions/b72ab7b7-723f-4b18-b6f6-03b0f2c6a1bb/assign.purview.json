{
    "properties": {
        "metadata": {
            "assignedBy": "github.com/hmcts/azure-policy"
        },
        "description": "Forwards all Azure Purview Activity Logs to an Azure Event Hub",
        "displayName": "HMCTS Purview Security Activity Logging - CFT SBOX (DCD-CFTAPPS-SBOX)",
        "enforcementMode": "Default",
        "nonComplianceMessages": [],
        "notScopes": [
            "/subscriptions/b72ab7b7-723f-4b18-b6f6-03b0f2c6a1bb/resourceGroups/cft-sbox-00-aks-node-rg",
            "/subscriptions/b72ab7b7-723f-4b18-b6f6-03b0f2c6a1bb/resourceGroups/cft-sbox-01-aks-node-rg",
            "/subscriptions/b72ab7b7-723f-4b18-b6f6-03b0f2c6a1bb/resourceGroups/lz-sbox-rg",
            "/subscriptions/b72ab7b7-723f-4b18-b6f6-03b0f2c6a1bb/resourceGroups/oz-rg",
            "/subscriptions/b72ab7b7-723f-4b18-b6f6-03b0f2c6a1bb/resourceGroups/rsi-nd-rg", 
            "/subscriptions/b72ab7b7-723f-4b18-b6f6-03b0f2c6a1bb/resourceGroups/afdpe-poc-rg"
          ],
        "parameters": {
            "eventHubAuthRule": {
                "value": "/subscriptions/2307d175-7e49-434b-9ac2-515529b845f2/resourceGroups/soc-core-infra-sbox-rg/providers/Microsoft.EventHub/namespaces/soc-sbox-eventhubns/authorizationRules/RootManageSharedAccessKey"
            }
        },
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/HMCTS/providers/Microsoft.Authorization/policyDefinitions/HMCTSPurview",
        "scope": "/subscriptions/b72ab7b7-723f-4b18-b6f6-03b0f2c6a1bb"
    },
    "location": "uksouth",
    "identity": {
        "type": "UserAssigned",
        "userAssignedIdentities": {
            "/subscriptions/2307d175-7e49-434b-9ac2-515529b845f2/resourceGroups/soc-core-infra-sbox-rg/providers/Microsoft.ManagedIdentity/userAssignedIdentities/soc-sbox-eventhub-azure-policy": {}
        }
    },
    "sku": {
        "name": "A0",
        "tier": "Free"
    },
    "type": "Microsoft.Authorization/policyAssignments",
    "id": "/subscriptions/b72ab7b7-723f-4b18-b6f6-03b0f2c6a1bb/providers/Microsoft.Authorization/policyDefinitions/HMCTSPurview_DCD-CFTAPPS-SBOX",
    "name": "HMCTSPurview_DCD-CFTAPPS-SBOX"
} 