{
    "properties": {
        "metadata": {
            "assignedBy": "https://github.com/hmcts/azure-policy"
        },
        "description": "Forwards Network Security Group Logs from prod resource group to Azure Event Hub - MOJ",
        "displayName": "HMCTS Collect NSG Logs prod (Production Subscription)",
        "enforcementMode": "Default",
        "nonComplianceMessages": [],
        "notScopes": [],
        "parameters": {
            "profileName": {
                "value": "nsgToEventHubMOJ"
            },
            "eventHubName": {
                "value": "azure-resource-events"
            },
            "eventHubAuthRule": {
                "value": "/subscriptions/8ae5b3b6-0b12-4888-b894-4cec33c92292/resourceGroups/soc-xsiam-eventhubs-prod-rg/providers/Microsoft.EventHub/namespaces/soc-prod-xsiam-eventhubns/authorizationrules/soc-xsiam-eventhub-namespace-sender"
            },
            "eventHubLocation": {
                "value": "uksouth"
            },
            "logsEnabled": {
                "value": "True"
            }
        },
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/HMCTS/providers/Microsoft.Authorization/policyDefinitions/HMCTSNSGDiagnostic",
        "scope": "/subscriptions/17390ec1-5a5e-4a20-afb3-38d8d726ae45/resourceGroups/InternalSpoke-rg"
    },
    "location": "uksouth",
    "identity": {
        "type": "UserAssigned",
        "userAssignedIdentities": {
            "/subscriptions/8ae5b3b6-0b12-4888-b894-4cec33c92292/resourceGroups/soc-core-infra-prod-rg/providers/Microsoft.ManagedIdentity/userAssignedIdentities/soc-prod-eventhub-azure-policy": {}
        }
    },
    "sku": {
        "name": "A0",
        "tier": "Free"
    },
    "type": "Microsoft.Authorization/policyAssignments",
    "id": "/subscriptions/17390ec1-5a5e-4a20-afb3-38d8d726ae45/resourceGroups/InternalSpoke-rg/providers/Microsoft.Authorization/policyAssignments/HMCTSNSGDiagnostic_prod",
    "name": "HMCTSNSGDiagnostic_prod"
}
