{
    "properties": {
      "metadata": {
        "assignedBy": "github.com/hmcts/azure-policy"
      },
      "description": "Forwards all Azure KeyVault Activity Logs to an Azure Event Hub",
      "displayName": "HMCTS Keyvault Security Activity Logging - HMCTS-SOC-SBOX",
      "enforcementMode": "Default",
      "nonComplianceMessages": [],
      "notScopes": [],
      "parameters": {
        "eventHubAuthRule": {
          "value": "/subscriptions/2307d175-7e49-434b-9ac2-515529b845f2/resourceGroups/soc-core-infra-sbox-rg/providers/Microsoft.EventHub/namespaces/soc-sbox-eventhubns/authorizationRules/RootManageSharedAccessKey"
        }
      },
      "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/dts002/providers/Microsoft.Authorization/policyDefinitions/HMCTSKeyVault",
      "scope":"/subscriptions/2307d175-7e49-434b-9ac2-515529b845f2"
    },
    "location": "uksouth",
    "identity": {
      "type": "UserAssigned",
      "userAssignedIdentities": {
        "/subscriptions/2307d175-7e49-434b-9ac2-515529b845f2/resourceGroups/soc-core-infra-sbox-rg/providers/Microsoft.ManagedIdentity/userAssignedIdentities/eventhub-azure-policy": {}
    }
    },
    "sku": {
      "name": "A0",
      "tier": "Free"
    },
    "type": "Microsoft.Authorization/policyAssignments",
    "id": "/subscriptions/2307d175-7e49-434b-9ac2-515529b845f2/providers/Microsoft.Authorization/policyAssignments/HMCTSKeyVault_HMCTS-SOC-SBOX",
    "name": "HMCTSKeyVault_HMCTS-SOC-SBOX"
}