{
  "properties": {
    "metadata": {
      "assignedBy": "github.com/hmcts/azure-policy"
    },
    "description": "Audit AKS Clusters where services do not listen on approved ports",
    "displayName": "AKS Restrict Service Allowed Ports (mg:HMCTS) ",
    "enforcementMode": "Default",
    "notScopes": [],
    "parameters": {
      "effect": {
        "value": "Audit"
      },
      "allowedServicePortsList": {
        "value": [
          "443",
          "80",
          "5432",
          "8443",
          "9402",
          "9094",
          "2115",
          "9093",
          "8080",
          "9090",
          "9100",
          "10443",
          "8082",
          "50000",
          "9666",
          "1494",
          "9411",
          "9600",
          "5140",
          "2020",
          "18301",
          "2000",
          "7979",
          "587",
          "9636",
          "6379",
          "8089",
          "9443",
          "27017",
          "4222",
          "8222",
          "8081",
          "9300"
        ]
      }
    },
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/233a2a17-77ca-4fb1-9b6b-69223d272a44",
    "scope": "/providers/Microsoft.Management/managementGroups/HMCTS"
  },
  "type": "Microsoft.Authorization/policyAssignments",
  "id": "/providers/Microsoft.Management/managementGroups/HMCTS/providers/Microsoft.Authorization/policyAssignments/AKSRstrctSvcPorts-hmcts",
  "name": "AKSRstrctSvcPorts-hmcts",
  "location": "uksouth",
  "sku": {
    "name": "A0",
    "tier": "Free"
  }
}
